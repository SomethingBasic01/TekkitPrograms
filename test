local chestName, dispenserName

-- Scan and find peripherals dynamically
local function findPeripherals()
    local peripherals = peripheral.getNames()
    for _, name in ipairs(peripherals) do
        if name:find("minecraft:chest") then
            chestName = name
        elseif name:find("minecraft:dispenser") then
            dispenserName = name
        end
    end
end

-- Function to transfer items from dispenser to chest
local function transferItems()
    if dispenserName and chestName then
        local dispenser = peripheral.wrap(dispenserName)
        local chest = peripheral.wrap(chestName)

        if dispenser and chest then
            -- Iterate through the dispenser slots
            for slot, item in pairs(dispenser.list()) do
                -- Try to push the items to the chest
                local moved = dispenser.pushItems(peripheral.getName(chest), slot)
                if moved == 0 then
                    print("Failed to move item from dispenser to chest.")
                else
                    print("Moved " .. moved .. " items from dispenser to chest.")
                end
            end
        else
            print("Failed to wrap either dispenser or chest.")
        end
    else
        print("Dispenser or chest not found.")
    end
end

-- Main function to run the program
local function main()
    findPeripherals()

    -- Check if the peripherals are found
    if chestName and dispenserName then
        print("Chest found: " .. chestName)
        print("Dispenser found: " .. dispenserName)
        transferItems()
    else
        print("Failed to detect necessary peripherals. Cannot proceed.")
    end
end

-- Run the main function
main()
